<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PGSoft API Debug Dashboard</title>

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #0f172a;
      color: #e2e8f0;
      font-family: 'Inter', sans-serif;
    }
    pre {
      white-space: pre-wrap;
      word-wrap: break-word;
    }
  </style>
</head>
<body>
  <div id="root" class="min-h-screen flex items-center justify-center"></div>

  <script type="text/javascript">
    const { useState, useEffect } = React;
    const API_BASE_URL = "https://pg-api-pg.rkfmzx.easypanel.host";

    function PGSoftDashboard() {
      const [games] = useState([
        { id: "fortune-tiger", name: "Fortune Tiger", icon: "ðŸ¯" },
        { id: "fortune-rabbit", name: "Fortune Rabbit", icon: "ðŸ°" },
        { id: "fortune-ox", name: "Fortune Ox", icon: "ðŸ‚" },
        { id: "fortune-mouse", name: "Fortune Mouse", icon: "ðŸ­" },
        { id: "ganesha-gold", name: "Ganesha Gold", icon: "ðŸ˜" },
        { id: "bikine-paradise", name: "Bikini Paradise", icon: "ðŸ–ï¸" },
        { id: "fortune-dragon", name: "Dragon Hatch", icon: "ðŸ‰" },
        { id: "dragon-tiger-luck", name: "Mahjong Ways 2", icon: "ðŸ€„" },
      ]);

      const [selectedGame, setSelectedGame] = useState(null);
      const [logs, setLogs] = useState([]);
      const [loading, setLoading] = useState(false);

      const log = (msg, data = null) => {
        console.log(msg, data || "");
        setLogs(prev => [
          { time: new Date().toLocaleTimeString(), msg, data },
          ...prev,
        ]);
      };

      const makeAPICall = async (endpoint, method = "POST", body = null) => {
        const url = API_BASE_URL + endpoint;
        setLoading(true);
        const start = Date.now();
        log(`âž¡ï¸ Chamando ${method} ${url}`, body);

        try {
          const response = await fetch(url, {
            method,
            headers: { "Content-Type": "application/json" },
            body: body ? JSON.stringify(body) : undefined,
          });

          const elapsed = Date.now() - start;
          const text = await response.text();
          let parsed;
          try {
            parsed = JSON.parse(text);
          } catch {
            parsed = text;
          }

          log(`âœ… Resposta (${response.status}) em ${elapsed}ms`, parsed);
        } catch (error) {
          log(`âŒ Erro na requisiÃ§Ã£o: ${error.message}`);
        } finally {
          setLoading(false);
        }
      };

      const handleGameInfo = (g) => {
        setSelectedGame(g);
        makeAPICall(`/game-api/${g.id}/v2/GameInfo/Get`);
      };

      const handleSpin = (g) => {
        makeAPICall(`/game-api/${g.id}/v2/Spin`);
      };

      return React.createElement(
        "div",
        { className: "p-6 max-w-6xl w-full" },
        React.createElement(
          "h1",
          { className: "text-3xl font-bold mb-4 text-center" },
          "ðŸŽ° PGSoft API Debug Dashboard"
        ),

        React.createElement(
          "div",
          { className: "grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3 mb-6" },
          games.map((g) =>
            React.createElement(
              "button",
              {
                key: g.id,
                className: `p-4 rounded-xl border border-slate-600 hover:bg-slate-700 transition ${
                  selectedGame && selectedGame.id === g.id ? "bg-slate-700" : ""
                }`,
                onClick: () => handleGameInfo(g),
              },
              React.createElement("div", { className: "text-3xl" }, g.icon),
              React.createElement("div", { className: "text-sm mt-2" }, g.name)
            )
          )
        ),

        selectedGame &&
          React.createElement(
            "div",
            { className: "mb-4 text-center" },
            React.createElement(
              "h2",
              { className: "text-xl mb-2" },
              `ðŸŽ® ${selectedGame.name}`
            ),
            React.createElement(
              "button",
              {
                className:
                  "bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition",
                onClick: () => handleSpin(selectedGame),
              },
              "ðŸŽ¯ Fazer SPIN"
            )
          ),

        loading &&
          React.createElement(
            "div",
            { className: "text-yellow-400 text-center mb-3" },
            "â³ Carregando..."
          ),

        React.createElement(
          "div",
          {
            className:
              "bg-slate-800 rounded-lg p-4 max-h-[400px] overflow-auto text-xs",
          },
          logs.length === 0
            ? "Nenhuma requisiÃ§Ã£o ainda."
            : logs.map((l, i) =>
                React.createElement(
                  "div",
                  { key: i, className: "mb-3 border-b border-slate-700 pb-2" },
                  React.createElement(
                    "div",
                    { className: "text-slate-400" },
                    `[${l.time}] ${l.msg}`
                  ),
                  l.data &&
                    React.createElement(
                      "pre",
                      { className: "text-slate-200 mt-1" },
                      typeof l.data === "string"
                        ? l.data
                        : JSON.stringify(l.data, null, 2)
                    )
                )
              )
        )
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(
      React.createElement(PGSoftDashboard)
    );
  </script>
</body>
</html>
